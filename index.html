<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chef VZLA - Dashboard Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        [x-cloak] { display: none !important; }
        body { background-color: #f3f4f6; font-family: 'Segoe UI', sans-serif; }
        /* AnimaciÃ³n suave para el modal */
        .modal-enter { opacity: 0; transform: scale(0.95); }
        .modal-enter-active { transition: all 0.2s ease-out; }
        .modal-leave-active { transition: all 0.2s ease-in; }
        .modal-leave { opacity: 0; transform: scale(0.95); }
    </style>
</head>

<body class="h-screen flex flex-col overflow-hidden text-slate-800" x-data="app()">

    <nav class="bg-white border-b h-16 shrink-0 flex items-center justify-between px-6 shadow-sm z-30">
        <div class="flex items-center gap-2">
            <div class="bg-yellow-500 text-white w-8 h-8 rounded flex items-center justify-center font-bold shadow">
                <i class="fas fa-utensils"></i>
            </div>
            <span class="font-bold text-lg tracking-tight">Chef<span class="text-yellow-600">VZLA</span></span>
        </div>
        
        <div class="flex bg-slate-100 rounded-lg p-1 text-xs font-bold border">
            <div class="flex items-center px-3 border-r border-slate-300 gap-2">
                <i class="fas fa-user text-slate-400"></i>
                <span>ADULTOS:</span>
                <input type="number" x-model.number="config.adultos" class="w-8 bg-transparent text-center focus:outline-none text-slate-700">
            </div>
            <div class="flex items-center px-3 gap-2">
                <i class="fas fa-baby text-slate-400"></i>
                <span>NIÃ‘OS:</span>
                <input type="number" x-model.number="config.ninos" class="w-8 bg-transparent text-center focus:outline-none text-slate-700">
            </div>
        </div>
    </nav>

    <div class="flex-1 flex overflow-hidden">
        
        <aside class="w-72 bg-white border-r flex flex-col z-20 hidden md:flex">
            <div class="p-5 border-b bg-slate-50">
                <h2 class="font-bold text-slate-700 mb-1">ðŸ“¦ Tu Nevera</h2>
                <p class="text-xs text-slate-400">Ingredientes disponibles</p>
            </div>
            
            <div class="flex-1 overflow-y-auto p-4 space-y-2">
                <template x-for="(item, index) in inventario" :key="index">
                    <div class="flex justify-between items-center p-2 rounded border border-slate-100 bg-white shadow-sm text-sm hover:border-yellow-400 transition group">
                        <span class="font-medium text-slate-700 truncate w-32" x-text="item.nombre"></span>
                        <div class="flex items-center gap-2">
                            <span class="text-xs bg-slate-100 px-1.5 rounded text-slate-500 font-bold">
                                <span x-text="item.cantidad"></span><span x-text="item.unidad"></span>
                            </span>
                            <button @click="eliminarItem(index)" class="text-red-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition"><i class="fas fa-times"></i></button>
                        </div>
                    </div>
                </template>
                
                <div x-show="inventario.length === 0" class="text-center py-8 text-slate-400 text-sm">
                    <i class="fas fa-box-open text-2xl mb-2 opacity-50"></i>
                    <p>La nevera estÃ¡ vacÃ­a.</p>
                </div>
            </div>

            <div class="p-4 border-t bg-slate-50">
                <button @click="toggleAddModal()" class="w-full bg-slate-800 hover:bg-slate-700 text-white font-bold py-2 rounded-lg text-sm shadow transition flex items-center justify-center gap-2">
                    <i class="fas fa-cart-plus"></i> Agregar Compra
                </button>
            </div>
        </aside>

        <main class="flex-1 flex flex-col overflow-y-auto bg-slate-100 p-4 md:p-8 relative">
            
            <div class="mb-8 grid md:grid-cols-2 gap-4">
                <div class="bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl p-5 text-white shadow-lg relative overflow-hidden">
                    <i class="fas fa-lightbulb absolute -right-4 -bottom-4 text-8xl text-white opacity-20"></i>
                    <h3 class="font-bold text-lg mb-1"><i class="fas fa-hat-chef mr-2"></i>Tip del DÃ­a</h3>
                    <p class="text-sm opacity-90 leading-relaxed" x-text="tipDelDia"></p>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-white p-4 rounded-xl shadow-sm border flex flex-col justify-center items-center">
                        <span class="text-3xl font-bold text-slate-700" x-text="inventario.length"></span>
                        <span class="text-xs text-slate-400 font-bold uppercase">Ingredientes</span>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border flex flex-col justify-center items-center">
                        <span class="text-3xl font-bold text-green-500" x-text="recetasDisponiblesCount"></span>
                        <span class="text-xs text-slate-400 font-bold uppercase">Recetas Posibles</span>
                    </div>
                </div>
            </div>

            <div class="relative mb-8 group z-10">
                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                    <i class="fas fa-search text-slate-400 text-lg group-focus-within:text-yellow-500 transition"></i>
                </div>
                <input type="text" x-model="busqueda" 
                       placeholder="Â¿QuÃ© quieres comer hoy? (Ej: AtÃºn, Pollo, Arepa...)" 
                       class="w-full pl-12 pr-4 py-4 rounded-2xl border-0 shadow-md focus:ring-4 focus:ring-yellow-200 transition text-lg bg-white placeholder-slate-400">
                
                <div x-show="busqueda.length > 0" class="absolute top-4 right-4 text-xs text-slate-400 font-bold">
                    Buscando ideas...
                </div>
            </div>

            <div>
                <div class="flex justify-between items-end mb-4">
                    <h2 class="text-xl font-bold text-slate-800">
                        <span x-show="busqueda === ''">ðŸ”¥ Sugerencias con lo que tienes</span>
                        <span x-show="busqueda !== ''">ðŸ”Ž Resultados para "<span x-text="busqueda"></span>"</span>
                    </h2>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-10">
                    
                    <template x-for="receta in recetasFiltradas" :key="receta.nombre">
                        <div @click="abrirReceta(receta)" 
                             class="bg-white rounded-xl shadow-sm hover:shadow-xl hover:-translate-y-1 transition duration-300 cursor-pointer border border-transparent hover:border-yellow-400 overflow-hidden flex flex-col h-full group">
                            
                            <div class="h-24 bg-slate-200 relative overflow-hidden">
                                <div class="absolute inset-0 bg-gradient-to-br from-slate-200 to-slate-300"></div>
                                <div class="absolute bottom-2 left-3 bg-white/90 px-2 py-1 rounded text-xs font-bold shadow-sm backdrop-blur-sm">
                                    <i class="fas fa-clock mr-1 text-slate-400"></i> 20-30 min
                                </div>
                                <div class="absolute top-2 right-2">
                                    <span x-show="verificarStock(receta)" class="bg-green-500 text-white text-[10px] font-bold px-2 py-1 rounded shadow">LISTO</span>
                                    <span x-show="!verificarStock(receta)" class="bg-orange-400 text-white text-[10px] font-bold px-2 py-1 rounded shadow">FALTA COMPRA</span>
                                </div>
                            </div>

                            <div class="p-4 flex-1 flex flex-col">
                                <h3 class="font-bold text-lg text-slate-800 leading-tight mb-1 group-hover:text-yellow-600 transition" x-text="receta.nombre"></h3>
                                <p class="text-xs text-slate-500 line-clamp-2 mb-4" x-text="receta.desc"></p>
                                
                                <div class="mt-auto pt-3 border-t border-slate-100 flex justify-between items-center text-xs text-slate-400">
                                    <span><i class="fas fa-list-ul mr-1"></i> <span x-text="Object.keys(receta.ingredientes).length"></span> Ingred.</span>
                                    <span class="text-yellow-600 font-bold group-hover:underline">Ver Receta &rarr;</span>
                                </div>
                            </div>
                        </div>
                    </template>

                    <template x-for="idea in ideasGeneradas" :key="idea.nombre">
                        <div @click="abrirIdea(idea)" class="bg-white border-2 border-dashed border-slate-300 rounded-xl p-4 flex flex-col justify-center items-center text-center cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition group h-full">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-500 mb-3 group-hover:scale-110 transition">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <h3 class="font-bold text-slate-700" x-text="idea.nombre"></h3>
                            <p class="text-xs text-slate-500 mt-1 px-2">Idea sugerida con <span x-text="busqueda"></span>. Haz clic para buscar cÃ³mo hacerla.</p>
                            <span class="mt-3 text-xs font-bold text-blue-600 bg-blue-100 px-2 py-1 rounded">Buscar Receta en Web</span>
                        </div>
                    </template>
                </div>

                <div x-show="recetasFiltradas.length === 0 && ideasGeneradas.length === 0" class="text-center py-12">
                    <i class="fas fa-search text-4xl text-slate-300 mb-4"></i>
                    <p class="text-slate-500">No encontramos recetas exactas.</p>
                    <p class="text-sm text-slate-400">Intenta buscar por ingrediente (ej. "Arroz", "Huevo").</p>
                </div>
            </div>
        </main>
    </div>

    <div x-show="modalOpen" x-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6">
        <div x-show="modalOpen" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" 
             @click="cerrarReceta()" class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm"></div>

        <div x-show="modalOpen" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 scale-95 translate-y-4" x-transition:enter-end="opacity-100 scale-100 translate-y-0" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100 scale-100 translate-y-0" x-transition:leave-end="opacity-0 scale-95 translate-y-4"
             class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col md:flex-row relative z-10">
            
            <button @click="cerrarReceta()" class="absolute top-4 right-4 z-20 bg-white/80 hover:bg-white p-2 rounded-full shadow transition text-slate-600">
                <i class="fas fa-times text-xl"></i>
            </button>

            <template x-if="recetaActiva">
                <div class="contents">
                    <div class="md:w-1/3 bg-slate-50 border-r p-6 flex flex-col overflow-y-auto">
                        <div class="mb-6">
                            <span class="text-xs font-bold uppercase tracking-wider text-yellow-600 mb-2 block" x-text="recetaActiva.tipo"></span>
                            <h2 class="text-3xl font-bold text-slate-800 leading-tight mb-2" x-text="recetaActiva.nombre"></h2>
                            <p class="text-sm text-slate-500 leading-relaxed" x-text="recetaActiva.desc"></p>
                        </div>

                        <div class="mb-6">
                            <a :href="'https://www.youtube.com/results?search_query=receta+venezolana+' + recetaActiva.nombre" target="_blank" 
                               class="group block w-full bg-red-600 hover:bg-red-700 text-white rounded-xl overflow-hidden shadow-lg transition transform hover:scale-[1.02]">
                                <div class="p-4 flex items-center justify-center gap-3">
                                    <i class="fab fa-youtube text-3xl"></i>
                                    <div class="text-left">
                                        <div class="font-bold text-sm">Ver Video Paso a Paso</div>
                                        <div class="text-[10px] opacity-80">Buscar en YouTube</div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <div class="mt-auto">
                            <div class="bg-white p-4 rounded-xl border shadow-sm">
                                <h4 class="font-bold text-slate-700 mb-2 text-sm">Estado de Inventario</h4>
                                <div x-show="verificarStock(recetaActiva)" class="text-green-600 text-sm font-bold flex items-center gap-2">
                                    <i class="fas fa-check-circle"></i> Tienes todo
                                </div>
                                <div x-show="!verificarStock(recetaActiva)" class="text-red-500 text-sm font-bold flex items-center gap-2">
                                    <i class="fas fa-exclamation-circle"></i> Faltan cosas
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="md:w-2/3 p-6 overflow-y-auto bg-white">
                        <div class="mb-8">
                            <h3 class="font-bold text-lg text-slate-800 mb-4 border-b pb-2">
                                ðŸ¥˜ Ingredientes <span class="text-xs font-normal text-slate-500 ml-2">(Para <span x-text="config.adultos + config.ninos"></span> personas)</span>
                            </h3>
                            <ul class="space-y-3">
                                <template x-for="(cantBase, ing) in recetaActiva.ingredientes">
                                    <li class="flex justify-between items-center text-sm p-2 rounded hover:bg-slate-50 transition">
                                        <div class="flex items-center gap-3">
                                            <div class="w-5 h-5 rounded-full flex items-center justify-center text-[10px] border"
                                                 :class="tieneIngrediente(ing, calcularCantidad(cantBase)) ? 'bg-green-100 border-green-300 text-green-700' : 'bg-red-50 border-red-200 text-red-400'">
                                                <i class="fas" :class="tieneIngrediente(ing, calcularCantidad(cantBase)) ? 'fa-check' : 'fa-times'"></i>
                                            </div>
                                            <span :class="tieneIngrediente(ing, calcularCantidad(cantBase)) ? 'text-slate-700' : 'text-red-500 font-bold'" x-text="ing"></span>
                                        </div>
                                        <div class="font-mono font-bold text-slate-600 bg-slate-100 px-2 py-1 rounded">
                                            <span x-text="calcularCantidad(cantBase)"></span> <span x-text="obtenerUnidad(ing)"></span>
                                        </div>
                                    </li>
                                </template>
                            </ul>
                        </div>

                        <div class="mb-8">
                            <h3 class="font-bold text-lg text-slate-800 mb-4 border-b pb-2">ðŸ”ª PreparaciÃ³n</h3>
                            <div class="space-y-6">
                                <template x-for="(paso, idx) in recetaActiva.preparacion">
                                    <div class="flex gap-4">
                                        <span class="flex-shrink-0 w-8 h-8 bg-yellow-100 text-yellow-700 font-bold rounded-full flex items-center justify-center text-sm shadow-sm" x-text="idx + 1"></span>
                                        <p class="text-slate-600 leading-relaxed pt-1 text-sm" x-text="paso"></p>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <div class="pt-4 border-t">
                            <button @click="cocinar()" 
                                    :disabled="!verificarStock(recetaActiva)"
                                    class="w-full py-4 rounded-xl font-bold text-white shadow-lg transition transform active:scale-95 flex items-center justify-center gap-2"
                                    :class="verificarStock(recetaActiva) ? 'bg-slate-800 hover:bg-slate-900' : 'bg-slate-300 cursor-not-allowed'">
                                <i class="fas fa-fire-alt"></i>
                                <span x-text="verificarStock(recetaActiva) ? 'COCINAR (Actualizar Inventario)' : 'NO PUEDES COCINAR (Faltan Ingredientes)'"></span>
                            </button>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <div x-show="addModalOpen" x-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/50 backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-md p-6 relative">
            <button @click="toggleAddModal()" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600"><i class="fas fa-times"></i></button>
            <h3 class="text-xl font-bold mb-4 text-slate-800">ðŸ›’ Agregar a la Nevera</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-slate-500 mb-1">Producto</label>
                    <input type="text" x-model="nuevoItem.nombre" placeholder="Ej: Arroz, AtÃºn..." class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div class="flex gap-4">
                    <div class="flex-1">
                        <label class="block text-xs font-bold text-slate-500 mb-1">Cantidad</label>
                        <input type="number" x-model.number="nuevoItem.cantidad" class="w-full p-2 border rounded-lg">
                    </div>
                    <div class="w-24">
                        <label class="block text-xs font-bold text-slate-500 mb-1">Unidad</label>
                        <select x-model="nuevoItem.unidad" class="w-full p-2 border rounded-lg bg-white">
                            <option value="g">g</option>
                            <option value="ml">ml</option>
                            <option value="und">und</option>
                        </select>
                    </div>
                </div>
                <div class="pt-2">
                    <button @click="agregarItem()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow transition">
                        Guardar Compra
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function app() {
            return {
                // ESTADO
                modalOpen: false,
                addModalOpen: false,
                busqueda: '',
                recetaActiva: null,
                config: { adultos: 4, ninos: 1 },
                tipDelDia: "",
                tips: [
                    "Si el arroz te quedÃ³ salado, ponle una papa cruda pelada en el medio por 10 min.",
                    "Para que las caraotas ablanden rÃ¡pido, agrÃ©gales una pizca de bicarbonato al remojar.",
                    "El ajÃ­ dulce se congela mejor si lo picas y lo guardas con un chorrito de aceite.",
                    "Si la salsa de pasta estÃ¡ muy Ã¡cida, ponle una pizca de azÃºcar.",
                    "Usa el agua de la pasta para espesar la salsa, tiene almidÃ³n natural."
                ],

                // DATOS
                inventario: JSON.parse(localStorage.getItem('chefvzla_stock')) || [
                    { nombre: 'Harina de MaÃ­z', cantidad: 1000, unidad: 'g' },
                    { nombre: 'Arroz', cantidad: 2000, unidad: 'g' },
                    { nombre: 'Huevo', cantidad: 6, unidad: 'und' },
                    { nombre: 'Queso Duro', cantidad: 300, unidad: 'g' },
                    { nombre: 'Aceite', cantidad: 500, unidad: 'ml' },
                    { nombre: 'Cebolla', cantidad: 2, unidad: 'und' }
                ],
                nuevoItem: { nombre: '', cantidad: null, unidad: 'g' },

                // MEGA BASE DE DATOS (Simulando Internet)
                recetario: [
                    // --- CLASICOS ---
                    { nombre: 'Arepas con Perico', tipo: 'Desayuno', desc: 'Arepa rellena de revoltillo de huevo con tomate y cebolla.', ingredientes: { 'Harina de MaÃ­z': 100, 'Huevo': 1.5, 'Cebolla': 0.2, 'Tomate': 0.5 }, preparacion: ['Haz la masa y asalas.', 'SofrÃ­e cebolla y tomate.', 'Agrega huevos y revuelve.'] },
                    { nombre: 'PabellÃ³n Criollo', tipo: 'Almuerzo', desc: 'Caraotas, arroz, carne mechada y tajadas.', ingredientes: { 'Arroz': 80, 'Caraotas': 80, 'Carne': 100, 'Cebolla': 0.2 }, preparacion: ['Cocina caraotas blanditas.', 'Haz arroz blanco.', 'Guisar la carne desmechada.'] },
                    // --- ATUN ---
                    { nombre: 'Pasta con AtÃºn', tipo: 'Almuerzo', desc: 'Salsa rÃ¡pida de tomate y atÃºn.', ingredientes: { 'Pasta': 100, 'AtÃºn': 40, 'Tomate': 0.5, 'Cebolla': 0.2 }, preparacion: ['Hervir pasta.', 'SofreÃ­r aliÃ±os y agregar atÃºn.', 'Mezclar todo.'] },
                    { nombre: 'Croquetas de AtÃºn', tipo: 'Cena', desc: 'Bolitas fritas de atÃºn y papa o harina.', ingredientes: { 'AtÃºn': 50, 'Harina de MaÃ­z': 20, 'Huevo': 0.5, 'Cebolla': 0.1 }, preparacion: ['Mezclar atÃºn escurrido con huevo y harina.', 'Formar bolitas.', 'FreÃ­r hasta dorar.'] },
                    { nombre: 'Ensalada de AtÃºn', tipo: 'Cena Ligera', desc: 'AtÃºn con vegetales frescos.', ingredientes: { 'AtÃºn': 50, 'Tomate': 1, 'Cebolla': 0.3, 'Huevo': 1 }, preparacion: ['Picar todo pequeÃ±o.', 'Mezclar con mayonesa si tienes.', 'Servir con galletas o arepa.'] },
                    // --- POLLO ---
                    { nombre: 'Arroz con Pollo', tipo: 'Almuerzo', desc: 'Todo en una sola olla.', ingredientes: { 'Arroz': 100, 'Pollo': 150, 'AjÃ­ Dulce': 1, 'Cebolla': 0.2 }, preparacion: ['SofreÃ­r pollo.', 'Agregar arroz y agua con color.', 'Cocinar tapado.'] },
                    { nombre: 'Sopa de Pollo', tipo: 'Sopa', desc: 'Levanta muertos.', ingredientes: { 'Pollo': 120, 'Papa': 1, 'Cebolla': 0.2 }, preparacion: ['Hervir pollo con agua.', 'Agregar verduras picadas.', 'Sal al gusto.'] },
                    // --- GRANOS ---
                    { nombre: 'Lentejas Guisadas', tipo: 'Almuerzo', desc: 'Lentejas con papas y zanahoria.', ingredientes: { 'Lentejas': 80, 'Papa': 0.5, 'Cebolla': 0.2 }, preparacion: ['SofreÃ­r aliÃ±os.', 'Agregar lentejas y agua.', 'Cocinar hasta espesar.'] },
                    // --- SARDINAS ---
                    { nombre: 'Pasta con Sardinas', tipo: 'Almuerzo', desc: 'EconÃ³mico y nutritivo.', ingredientes: { 'Pasta': 100, 'Sardinas': 50, 'Tomate': 0.5 }, preparacion: ['Hervir pasta.', 'Desmenuzar sardinas en sofrito.', 'Mezclar.'] },
                    { nombre: 'Arepa con Sardina', tipo: 'Cena', desc: 'Relleno potente.', ingredientes: { 'Harina de MaÃ­z': 100, 'Sardinas': 40, 'Cebolla': 0.2 }, preparacion: ['Asar arepas.', 'Mezclar sardina con cebolla picadita (y mayonesa opcional).'] }
                ],

                init() {
                    this.tipDelDia = this.tips[Math.floor(Math.random() * this.tips.length)];
                    this.$watch('inventario', () => localStorage.setItem('chefvzla_stock', JSON.stringify(this.inventario)));
                },

                // --- LÃ“GICA PRINCIPAL ---

                toggleAddModal() { this.addModalOpen = !this.addModalOpen; },
                
                agregarItem() {
                    if(this.nuevoItem.nombre && this.nuevoItem.cantidad) {
                        let existe = this.inventario.find(i => i.nombre.toLowerCase() === this.nuevoItem.nombre.toLowerCase());
                        if(existe) existe.cantidad += this.nuevoItem.cantidad;
                        else this.inventario.push({...this.nuevoItem});
                        this.nuevoItem = { nombre: '', cantidad: null, unidad: 'g' };
                        this.toggleAddModal();
                    }
                },

                eliminarItem(index) {
                    if(confirm("Â¿Eliminar ingrediente?")) this.inventario.splice(index, 1);
                },

                // SISTEMA DE BUSQUEDA E "INTERNET"
                get recetasFiltradas() {
                    // 1. Si no hay bÃºsqueda, mostrar SUGERENCIAS (recetas donde tengo stock)
                    if (this.busqueda === '') {
                        return this.recetario
                            .filter(r => this.verificarStock(r))
                            .slice(0, 5); // Mostrar mÃ¡x 5
                    }
                    
                    // 2. Si hay bÃºsqueda, filtrar por nombre o ingrediente
                    const termino = this.busqueda.toLowerCase();
                    return this.recetario.filter(r => 
                        r.nombre.toLowerCase().includes(termino) || 
                        Object.keys(r.ingredientes).some(i => i.toLowerCase().includes(termino))
                    );
                },

                // Generador de Ideas (Para completar las 5 recetas solicitadas)
                get ideasGeneradas() {
                    if (this.busqueda === '') return [];
                    
                    const termino = this.busqueda;
                    // Si ya hay muchas recetas reales, no generar tantas ideas
                    if (this.recetasFiltradas.length >= 5) return [];

                    // Generar ideas genÃ©ricas basadas en el tÃ©rmino
                    return [
                        { nombre: `Tortilla de ${termino}`, desc: 'Mezcla con huevo y harina.', ingredientes: {} },
                        { nombre: `Guiso de ${termino}`, desc: 'Con salsa de tomate y cebolla.', ingredientes: {} },
                        { nombre: `${termino} Frito`, desc: 'Simple y crujiente.', ingredientes: {} }
                    ].slice(0, 5 - this.recetasFiltradas.length); // Rellenar hasta completar 5
                },

                get recetasDisponiblesCount() {
                    return this.recetario.filter(r => this.verificarStock(r)).length;
                },

                // --- GESTIÃ“N DE RECETA ---
                abrirReceta(receta) {
                    this.recetaActiva = receta;
                    this.modalOpen = true;
                },
                
                abrirIdea(idea) {
                    // Simular apertura de idea para buscar en internet
                    if(confirm(`No tenemos la receta exacta de "${idea.nombre}" en la base de datos interna. \n\nÂ¿Quieres buscarla en Google/YouTube?`)) {
                        window.open(`https://www.google.com/search?q=receta+venezolana+facil+${idea.nombre}`, '_blank');
                    }
                },

                cerrarReceta() {
                    this.modalOpen = false;
                    this.recetaActiva = null;
                },

                // CÃLCULOS
                calcularCantidad(base) {
                    return Math.ceil(base * (this.config.adultos + (this.config.ninos * 0.5)));
                },

                obtenerUnidad(ing) {
                    let item = this.inventario.find(i => i.nombre.toLowerCase().includes(ing.toLowerCase()));
                    return item ? item.unidad : 'g/u';
                },

                tieneIngrediente(nombre, necesario) {
                    // BÃºsqueda laxa (ej. "AtÃºn" coincide con "AtÃºn enlatado")
                    let item = this.inventario.find(i => i.nombre.toLowerCase().includes(nombre.toLowerCase()) || nombre.toLowerCase().includes(i.nombre.toLowerCase()));
                    return item && item.cantidad >= necesario;
                },

                verificarStock(receta) {
                    if (!receta.ingredientes) return false;
                    for (let [ing, cantBase] of Object.entries(receta.ingredientes)) {
                        if (!this.tieneIngrediente(ing, this.calcularCantidad(cantBase))) return false;
                    }
                    return true;
                },

                cocinar() {
                    if(!confirm("Â¿Confirmar preparaciÃ³n? Se descontarÃ¡n los ingredientes.")) return;
                    for (let [ing, cantBase] of Object.entries(this.recetaActiva.ingredientes)) {
                        let necesario = this.calcularCantidad(cantBase);
                        // Buscar item similar para descontar
                        let item = this.inventario.find(i => i.nombre.toLowerCase().includes(ing.toLowerCase()) || ing.toLowerCase().includes(i.nombre.toLowerCase()));
                        if(item) item.cantidad = Math.max(0, item.cantidad - necesario);
                    }
                    this.cerrarReceta();
                    alert("Â¡Buen provecho! Inventario actualizado.");
                }
            }
        }
    </script>
</body>
</html>
